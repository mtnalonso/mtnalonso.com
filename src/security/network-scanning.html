<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>mtnalonso.com</title>
        <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/css/nes.min.css">
        <link rel="stylesheet" type="text/css" href="/css/styles.css">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/default.min.css">
        <script src="https://unpkg.com/i18next/i18next.js"></script>
        <script src="https://unpkg.com/i18next-xhr-backend/i18nextXHRBackend.js"></script>
        <script src="https://unpkg.com/i18next-browser-languagedetector/i18nextBrowserLanguageDetector.js"></script>
        <script src="/js/script.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </head>
    <body>
        <nav>
            <hr class="no-js">
                <a class="nes-btn is-error" href="/"><-</a> |
                <a class="nes-btn" href="https://github.com/mtnalonso">GitHub</a> |
                <a class="nes-btn is-primary" href="https://www.linkedin.com/in/MartinAlonsoVilar">LinkedIn</a> |
                <a class="nes-btn is-success" href="/security">Security</a> |
                <a class="nes-btn is-warning" href="https://stackoverflow.com/users/5430648/martin-alonso">Stack Overflow</a> |
                <a class="nes-btn is-disabled" href="/privacy">Privacy</a>
            <hr class="no-js">
        </nav>
        <main>
            <h1 class="trn network-scanning-main-title">Network scanning</h1>
            <p class="trn network-scanning-desc">Network scanning is the process through which we obtained information about the target by identifying hosts, ports and servicies from within a network.</p>
            <br>
            <section id="scan-types-section" class="nes-container with-title">
                <h2 class="title"><span class="trn network-scanning-scan-types">Scan types</span></h2>
                <section class="nes-container with-title">
                    <h5 class="title">ICMP Echo Scan</h5>
                    Consiste en enviar peticiones ICMP ECHO a un equipo determinado. Si dicho equipo está operativo, este devolverá una respuesta ICMP ECHO.
                    <br><br>
                    <span class="nes-text is-primary">Ping sweep</span>: Técnica para identificar los diferentes equipos dentro de una red mediante el envio de peticiones ICMP ECHO a múltiples equipos. 
                </section>
                <section class="nes-container with-title border-blue">
                    <h5 class="title">TCP / Full Open Scan</h5>
                    Es la técnica de escaneo de puertos más fiable. Consiste en intentar establecer una conexión TCP con cada puerto del objetivo, para ello realiza un TCP 3-way handshake completo. Sin embargo este tipo de escaneo se puede detectar facilmente.
                </section>
                <section class="nes-container with-title border-green">
                    <h5 class="title">SYN / Stealth Scan</h5>
                    Este escaneo fuerza la interrupción de la conexión antes de que se establezca una conexión TCP. Es más sigiloso que un escaneo TCP completo.
                    <br><br>
                    <h4 class="nes-text is-primary">Funcionamiento</h4>
                    <div class="lists">
                        <ul class="nes-list is-circle">
                            <li>Se envía un paquete SYN al objetivo.</li>
                            <li>Si el puerto está abierto, se obtiene una respuesta SYN/ACK.</li>
                            <li>Si el puerto está cerrado, se obtiene una respuesta RST.</li>
                            <li>Se envía un paquete RST al objetivo, cerrando la conexión antes de que ésta se inicie por completo.</li>
                        </ul>
                    </div>
                </section>
                <section class="nes-container with-title border-yellow">
                    <h5 class="title">XMAS Scan</h5>
                    Este escaneo envía TCP peticiones con las flags FIN, URG y PUSH activas.<br>
                    Si el puerto objetivo está abierto, no se obtiene respuesta.<br>
                    Si el puerto objetivo está cerrado, se una respuesta RST.<br>
                </section>
                <section class="nes-container with-title border-red">
                    <h5 class="title">ACK flag probe scan</h5>
                    Este escaneo consiste en enviar paquetes TCP ACK y posteriormente analizar las cabeceras de la respuesta:
                    <br><br>
                    <div class="lists">
                        <ul class="nes-list is-circle">
                            <li>Si el valor del TTL de la respuesta RST es inferior a 64, el puerto está abierto.</li>
                            <li>Si el valor de la ventana (WINDOW) tiene un valor distinto de cero, el puerto está abierto.</li>
                        </ul>
                    También suele ser empleado para comprobar si existe algún tipo de filtrado en el objetivo:
                    <br><br>
                    <div class="lists">
                        <ul class="nes-list is-circle">
                            <li>Se envía una petición TCP ACK al objetivo</li>
                            <li>Si se obtiene una respuesta, el puerto objetivo no está filtrado</li>
                            <li>En caso contrario, probablemente exista algún tipo de filtrado.</li>
                        </ul>
                    </div>
                </section>
                <section class="nes-container with-title">
                    <h5 class="title">IDLE Scan</h5>
                    Este tipo de escaneo involucra el uso de una tercera máquina <em>zombie</em>...
                    <br><br>
                    <h4 class="nes-text is-primary">Funcionamiento</h4>
                    <div class="lists">
                        <ul class="nes-list is-circle">
                            <li>Se envía una paquete TCP con SYN + ACK al <em>zombie</em> para obtener su IPID.</li>
                            <li>El <em>zombie</em> devolverá una paquete TCP RST con un IPID determinado.</li>
                            <li>Se envía una paquete TCP SYN al objetivo con la dirección IP del <em>zombie</em>.</li>
                            <li>Si el puerto objetivo está abierto, el objetivo envía un paquete TCP SYN+ACK al <em>zombie</em>, respondiéndole éste con un paquete RST.</li>
                            <li>Si el puerto está cerrado, el objetivo envía un paquete RST al <em>zombie</em>.</li><br>
                            <li>Se envía un paquete al <em>zombie</em> para obtener su IPID actual. Si el valor del IPID se ha incrementado 2 unidades, el puerto objetivo está abierto; si sólo ha aumentado en 1 unidad, el puerto está cerrado.</li>
                        </ul>
                    </div>
                </section>
                <section class="nes-container with-title border-blue">
                    <h5 class="title">UDP Scan</h5>
                    Este escaneo emplea el protocolo UDP en lugar de TCP.
                    <br><br>
                    Si enviando un paquete UDP al objetivo, no se obtiene respuesta, el puerto puede estar abierto.<br>
                    <br>
                    Si enviando un paquete UDP al objetivo, éste responde con un mensaje ICMP "port unreachable", el puerto está cerrado.<br>
                </section>
            </section>
            <section id="scan-tools-section" class="nes-container with-title">
                <h2 class="title">Herramientas</h2>
                <section class="exp-container">
                    <section class="nes-container with-title">
                        <h5 class="title">nmap</h5>
                        Nmap es una potente herramienta Open-Source y gratuíta que permite auditar y enumerar redes.
                        <br><br>
                        <a href="https://nmap.org/book/man.html">Documentación oficial</a>
                        <button class="nes-btn is-primary btn-expand-container" onclick="expandContainer(this)" type="button">+</button>
                    </section>
                    <section class="exp-container-code">
                        <pre><code class="hljs bash">
# ICMP (Ping) scan
nmap -sP &lt;target-ip-address&gt;

# TCP scan
nmap -sT &lt;target-ip-address&gt;

# Stealth (SYN) scan
nmap -sS &lt;target-ip-address&gt;

# XMAS scan
nmap -sX &lt;target-ip-address&gt;

# ACK scan
nmap -sA &lt;target-ip-address&gt;

# WINDOW scan
nmap -sW &lt;target-ip-address&gt;

# UDP scan
nmap -sU &lt;target-ip-address&gt;
                            </code></pre>
                    </section>
                </section>
                <section class="exp-container">
                    <section class="nes-container with-title">
                        <h5 class="title">hping3</h5>
                        <button class="nes-btn is-primary btn-expand-container" type="button">+</button>
                    </section>
                    <section class="exp-container-code">
                    </section>
                </section>
            </section>
        </main>
    </body>
</html>
